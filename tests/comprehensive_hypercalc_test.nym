// Comprehensive Hypercalc Functions Test
// Testing special value handling, GMP integration, and complex number support

import math
import math.hypercalc
import crystal

func test_special_values() -> Void {
    crystal.manifest("Testing special value handling...")
    
    // Test basic arithmetic with large numbers (representing infinities)
    var huge_pos = math.hypercalc.POS_HUGE
    var huge_neg = math.hypercalc.NEG_HUGE
    
    crystal.manifest("POS_HUGE value: " + huge_pos)
    crystal.manifest("NEG_HUGE value: " + huge_neg)
    
    // Test addition with huge values
    var add_result = math.hypercalc.add(huge_pos, 5.0)
    crystal.manifest("POS_HUGE + 5 = " + add_result)
    
    var add_result2 = math.hypercalc.add(huge_pos, huge_neg)
    crystal.manifest("POS_HUGE + NEG_HUGE (should be NaN): " + add_result2)
    
    // Test division with zero and huge values
    var div_result = math.hypercalc.divide(10.0, 0.0)
    crystal.manifest("10 / 0 (should be POS_HUGE): " + div_result)
    
    var zero_div_result = math.hypercalc.divide(0.0, 0.0)
    crystal.manifest("0 / 0 (should be NaN): " + zero_div_result)
    
    crystal.manifest("Special value tests completed!")
}

func test_gmp_factorial() -> Void {
    crystal.manifest("Testing GMP BigInt factorial functions...")
    
    // Test simple factorial calculation
    var fact_5 = math.hypercalc.factorial_gmp(5)
    crystal.manifest("5! using GMP: " + fact_5.to_string())
    
    var fact_10 = math.hypercalc.factorial_gmp(10)
    crystal.manifest("10! using GMP: " + fact_10.to_string())
    
    // Test power function with BigInt
    var base = math.BigInt(2)
    var pow_result = math.hypercalc.pow_gmp(base, 10)
    crystal.manifest("2^10 using GMP: " + pow_result.to_string())
    
    var pow_result2 = math.hypercalc.pow_gmp(base, 20)
    crystal.manifest("2^20 using GMP: " + pow_result2.to_string())
    
    crystal.manifest("GMP tests completed!")
}

func test_trigonometric_functions() -> Void {
    crystal.manifest("Testing trigonometric functions with edge cases...")
    
    // Test standard values
    var sin_result = math.hypercalc.sin(math.PI / 2.0)
    crystal.manifest("sin(π/2) ≈ " + sin_result)
    
    var cos_result = math.hypercalc.cos(0.0)
    crystal.manifest("cos(0) = " + cos_result)
    
    var tan_result = math.hypercalc.tan(0.0)
    crystal.manifest("tan(0) = " + tan_result)
    
    // Test with large values
    var large_val = 1e15
    var sin_large = math.hypercalc.sin(large_val)
    crystal.manifest("sin(very_large_number) = " + sin_large)
    
    var cos_large = math.hypercalc.cos(large_val)
    crystal.manifest("cos(very_large_number) = " + cos_large)
    
    crystal.manifest("Trigonometric tests completed!")
}

func test_gamma_function() -> Void {
    crystal.manifest("Testing gamma function...")
    
    // Test gamma(n) = (n-1)! for positive integers
    var gamma_5 = math.hypercalc.gamma(5.0)  // Should be 4! = 24
    crystal.manifest("gamma(5) = " + gamma_5 + " (should be 24)")
    
    var gamma_6 = math.hypercalc.gamma(6.0)  // Should be 5! = 120
    crystal.manifest("gamma(6) = " + gamma_6 + " (should be 120)")
    
    // Test gamma(0.5) = sqrt(π)
    var gamma_half = math.hypercalc.gamma(0.5)
    var expected = math.sqrt(math.PI)
    crystal.manifest("gamma(0.5) = " + gamma_half + ", expected sqrt(π) ≈ " + expected)
    
    // Test factorial function
    var fact_5 = math.hypercalc.factorial(5.0)
    crystal.manifest("factorial(5) = " + fact_5 + " (should be 120)")
    
    var fact_0 = math.hypercalc.factorial(0.0)
    crystal.manifest("factorial(0) = " + fact_0 + " (should be 1)")
    
    crystal.manifest("Gamma function tests completed!")
}

func test_complex_functions() -> Void {
    crystal.manifest("Testing complex number functions...")
    
    // Create complex numbers
    var z1 = math.Complex(1.0, 2.0)
    var z2 = math.Complex(3.0, 4.0)
    
    crystal.manifest("z1 = " + z1.real + " + " + z1.imag + "i")
    crystal.manifest("z2 = " + z2.real + " + " + z2.imag + "i")
    
    // Test complex addition
    var z_add = math.hypercalc.complex_add(z1, z2)
    crystal.manifest("z1 + z2 = " + z_add.real + " + " + z_add.imag + "i")
    
    // Test complex multiplication
    var z_mult = math.hypercalc.complex_multiply(z1, z2)
    crystal.manifest("z1 * z2 = " + z_mult.real + " + " + z_mult.imag + "i")
    
    // Test complex subtraction
    var z_sub = math.hypercalc.complex_subtract(z1, z2)
    crystal.manifest("z1 - z2 = " + z_sub.real + " + " + z_sub.imag + "i")
    
    // Test complex division
    var z_div = math.hypercalc.complex_divide(z1, z2)
    crystal.manifest("z1 / z2 = " + z_div.real + " + " + z_div.imag + "i")
    
    // Test complex exponential (e^z where z is complex)
    var z_exp = math.hypercalc.complex_exp(z1)
    crystal.manifest("e^z1 = " + z_exp.real + " + " + z_exp.imag + "i")
    
    crystal.manifest("Complex function tests completed!")
}

func test_exponential_logarithmic() -> Void {
    crystal.manifest("Testing exponential and logarithmic functions...")
    
    // Test exp function
    var exp_1 = math.hypercalc.exp(1.0)
    crystal.manifest("exp(1) ≈ e = " + exp_1)
    
    var exp_0 = math.hypercalc.exp(0.0)
    crystal.manifest("exp(0) = " + exp_0)
    
    // Test natural logarithm
    var ln_e = math.hypercalc.ln(math.E)
    crystal.manifest("ln(e) = " + ln_e)
    
    var ln_1 = math.hypercalc.ln(1.0)
    crystal.manifest("ln(1) = " + ln_1)
    
    // Test power function
    var pow_result = math.hypercalc.pow(2.0, 8.0)
    crystal.manifest("2^8 = " + pow_result)
    
    var pow_negative = math.hypercalc.pow(-2.0, 3.0)
    crystal.manifest("(-2)^3 = " + pow_negative)
    
    // Test log base 10
    var log10_100 = math.hypercalc.log10(100.0)
    crystal.manifest("log10(100) = " + log10_100)
    
    var log10_1 = math.hypercalc.log10(1.0)
    crystal.manifest("log10(1) = " + log10_1)
    
    crystal.manifest("Exponential-logarithmic tests completed!")
}

func test_hyperbolic_functions() -> Void {
    crystal.manifest("Testing hyperbolic functions...")
    
    // Test standard values
    var sinh_0 = math.hypercalc.sinh(0.0)
    crystal.manifest("sinh(0) = " + sinh_0)
    
    var cosh_0 = math.hypercalc.cosh(0.0)
    crystal.manifest("cosh(0) = " + cosh_0)
    
    var tanh_0 = math.hypercalc.tanh(0.0)
    crystal.manifest("tanh(0) = " + tanh_0)
    
    // Test with a larger value
    var x = 1.0
    var sinh_x = math.hypercalc.sinh(x)
    var cosh_x = math.hypercalc.cosh(x)
    var tanh_x = math.hypercalc.tanh(x)
    crystal.manifest("sinh(1) = " + sinh_x)
    crystal.manifest("cosh(1) = " + cosh_x)
    crystal.manifest("tanh(1) = " + tanh_x)
    
    // Test identity: cosh²(x) - sinh²(x) = 1
    var identity_check = cosh_x * cosh_x - sinh_x * sinh_x
    crystal.manifest("cosh²(1) - sinh²(1) = " + identity_check + " (should be 1)")
    
    crystal.manifest("Hyperbolic function tests completed!")
}

func main() -> Void {
    test_special_values()
    test_gmp_factorial()
    test_trigonometric_functions()
    test_gamma_function()
    test_complex_functions()
    test_exponential_logarithmic()
    test_hyperbolic_functions()
    
    crystal.manifest("All comprehensive hypercalc function tests completed successfully!")
}